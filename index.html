<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,viewport-fit=cover"
    />
    <meta name="theme-color" content="#ffffff" />
    <title>
      第９回みんなで決めよう！ホントに美味しいお酒はこれだ！全国大会
    </title>
    <meta
      name="description"
      content="参加者ごとに日本酒を0〜10点で採点し、平均点ランキングを表示する投票ページ"
    />
    <link rel="stylesheet" href="./styles.css" />

    <script>
      // ★ GASの /exec URL（必要に応じて差し替え）
      window.GAS_API_URL =
        'https://script.google.com/macros/s/AKfycbyAEtKmtpdXL-Z5fzl4TuTHmWYv5K9AFQQgfleRwwbZZdc94L0LMtOlj1ujEK9JbcCwig/exec';
    </script>
  </head>

  <body>
    <noscript
      >このページを利用するにはJavaScriptを有効にしてください。</noscript
    >

    <header class="site-header">
      <div class="container">
        <h1>第９回みんなで決めよう！ホントに美味しいお酒はこれだ！全国大会</h1>
        <p class="lead">
          参加者情報より氏名を選択し、各銘柄を<span class="em">★（0〜10）</span
          >で採点してください。<br />
          送信後は<strong>最新の回答</strong>が有効になります（再送信可）。
        </p>
      </div>
    </header>

    <main class="container" id="main">
      <!-- 参加者情報 -->
      <section class="card" aria-labelledby="section-participant">
        <h2 id="section-participant">参加者情報</h2>
        <div class="field">
          <label for="nickname">参加者（必須）</label>
          <select id="nickname" required aria-describedby="nicknameHelp">
            <option value="" disabled selected hidden>読み込み中...</option>
          </select>
        </div>
      </section>

      <!-- 採点エリア -->
      <section class="card" aria-labelledby="section-score">
        <div class="card-head">
          <h2 id="section-score">採点（★0〜10）</h2>
          <div class="head-actions">
            <button
              id="clearBtn"
              class="btn ghost"
              type="button"
              aria-busy="false"
            >
              全リセット
            </button>
          </div>
        </div>

        <div
          id="sake-list"
          class="grid"
          aria-live="polite"
          aria-busy="true"
        ></div>

        <div class="actions">
          <button
            id="sendBtn"
            class="btn primary"
            type="button"
            disabled
            aria-busy="false"
          >
            投票する
          </button>
          <!-- ← メッセージはこの1つだけ（重複IDを解消） -->
          <span id="msg" class="msg" aria-live="polite" role="status"></span>
        </div>
      </section>

      <!-- 参加者セレクト（上部と連動） -->
      <!-- ※カード枠が不要なら sectionではなくdivでもOK。枠を出したくない場合は div にしてください。 -->
      <section class="card" aria-labelledby="section-participant-confirm">
        <h2 id="section-participant-confirm" class="sr-only">参加者確認</h2>
        <div class="field">
          <label for="nicknameConfirm">参加者（確認用）</label>
          <select id="nicknameConfirm" aria-describedby="nicknameConfirmHelp">
            <option value="" disabled selected hidden>読み込み中...</option>
          </select>
          <small id="nicknameConfirmHelp" class="help">
            上部の選択と連動します
          </small>
        </div>

        <div class="confirm-row">
          <div class="confirm-info">
            <span class="label">選択中の参加者：</span>
            <strong id="selectedName" class="selected-name">未選択</strong>
            様です。
          </div>
        </div>
      </section>

      <!-- ランキング（CSSで非表示にするならそのまま残してOK） -->
      <section class="card" aria-labelledby="section-ranking" hidden>
        <div class="card-head">
          <h2 id="section-ranking">現在のランキング（平均点）</h2>
          <button id="refreshBtn" class="btn" type="button" aria-busy="false">
            更新する
          </button>
        </div>
        <ol
          id="ranking"
          class="ranking"
          aria-live="polite"
          aria-busy="true"
        ></ol>
        <p id="meta" class="meta"></p>
      </section>
    </main>

    <footer class="site-footer">
      <div class="container">
        <small>© 日本酒試飲会</small>
      </div>
    </footer>

    <!-- deferでDOM構築後に実行／blockingを避ける -->
    <script src="./app.js" defer></script>
  </body>
</html>
